<!doctype html>
<html lang="pl">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="dark">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
  <link
    href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Inter:wght@300;400;500;600&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/drift-zoom@1/dist/drift-basic.min.css">

  <title>WysiÅ‚ki Labana â€” Trening GÅ‚osu</title>

  <link rel="stylesheet" href="style.css">
</head>

<body>

  <div class="app-shell" x-data="labana()" x-cloak x-init="init()">

    <!-- HEADER -->
    <div class="header">
      <h1>WysiÅ‚ki Labana</h1>
      <p>Trening gÅ‚osu postaci</p>
    </div>

    <!-- AXES LEGEND -->
    <div class="axes-strip">
      <div class="axes-chip"><span class="dot" style="background:var(--ax-ciezar)"></span> CiÄ™Å¼ar: Stanowczy / Delikatny
      </div>
      <div class="axes-chip"><span class="dot" style="background:var(--ax-czas)"></span> Czas: NagÅ‚y / TrwaÅ‚y</div>
      <div class="axes-chip"><span class="dot" style="background:var(--ax-prz)"></span> PrzestrzeÅ„: BezpoÅ›redni /
        PoÅ›redni</div>
    </div>

    <!-- MODE TABS -->
    <div class="mode-tabs">
      <button class="mode-tab" :class="{active: mode==='flash'}" @click="switchMode('flash')">ðŸ“š Nauka</button>
      <button class="mode-tab" :class="{active: mode==='quiz'}" @click="switchMode('quiz')">ðŸŽ¯ Quiz</button>
      <button class="mode-tab" :class="{active: mode==='gm'}" @click="switchMode('gm')">ðŸŽ­ Generuj PostaÄ‡</button>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MODE: NAUKA (FLASHCARDS)
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div x-show="mode === 'flash'">

      <!-- progress -->
      <div class="progress-wrap">
        <div class="progress-label">
          <span>PostÄ™p</span>
          <span x-text="flashQueue.length === 0 ? 'Gotowe!' : (flashIndex+1) + ' / ' + flashQueue.length"></span>
        </div>
        <div class="progress-track">
          <div class="progress-fill"
            :style="`width: ${flashQueue.length ? ((flashIndex)/flashQueue.length*100) : 100}%`"></div>
        </div>
      </div>

      <!-- scores -->
      <div class="score-ribbon">
        <div class="score-item">
          <div class="score-num green" x-text="flashScore.know"></div>
          <div class="score-lbl">Znam</div>
        </div>
        <div class="score-item">
          <div class="score-num red" x-text="flashScore.dontknow"></div>
          <div class="score-lbl">Nie znam</div>
        </div>
        <div class="score-item">
          <div class="score-num gold" x-text="flashScore.streak"></div>
          <div class="score-lbl">SeriÄ™</div>
        </div>
      </div>

      <!-- CARD or DONE message -->
      <template x-if="flashQueue.length > 0">
        <div>
          <!-- 3D Flashcard -->
          <div class="flashcard-scene">
            <div class="flashcard" :class="{flipped: flashFlipped}" @click="flashFlipped = !flashFlipped"
              :key="flashIndex">
              <!-- FRONT -->
              <div class="flashcard-face front">
                <div class="card-effort-name" x-text="currentFlash().name"></div>
                <div class="card-code">
                  <span :style="`color:var(--ax-ciezar)`" x-text="currentFlash().code[0]"></span><!--
                --><span :style="`color:var(--ax-czas)`" x-text="currentFlash().code[1]"></span><!--
                --><span :style="`color:var(--ax-prz)`" x-text="currentFlash().code[2]"></span>
                </div>
                <!-- mini cube -->
                <div class="cube-mini">
                  <div class="cube-mini-inner">
                    <div class="cube-face front" :class="{lit: currentFlash().prz==='B'}">
                      <div class="cube-face-content">BezpoÅ›redni</div>
                    </div>
                    <div class="cube-face back2" :class="{lit: currentFlash().prz==='P'}">
                      <div class="cube-face-content">PoÅ›redni</div>
                    </div>
                    <div class="right cube-face" :class="{lit: currentFlash().czas==='N'}">
                      <div class="cube-face-content">NagÅ‚y</div>
                    </div>
                    <div class="left cube-face" :class="{lit: currentFlash().czas==='T'}">
                      <div class="cube-face-content">TrwaÅ‚y</div>
                    </div>
                    <div class="top cube-face" :class="{lit: currentFlash().ciezar==='S'}">
                      <div class="cube-face-content">Stanowczy</div>
                    </div>
                    <div class="bottom cube-face" :class="{lit: currentFlash().ciezar==='D'}">
                      <div class="cube-face-content">Delikatny</div>
                    </div>
                  </div>
                </div>
                <div class="card-tap-hint">Dotknij, Å¼eby odsÅ‚oniÄ‡ â–¼</div>
              </div>
              <!-- BACK -->
              <div class="flashcard-face back">
                <div class="card-effort-name" x-text="currentFlash().name" style="font-size:1.6rem;"></div>
                <div class="card-axes-row">
                  <div class="card-axis-badge">
                    <span class="dot" style="background:var(--ax-ciezar)"></span>
                    <span x-text="currentFlash().ciezar === 'S' ? 'Stanowczy' : 'Delikatny'"></span>
                  </div>
                  <div class="card-axis-badge">
                    <span class="dot" style="background:var(--ax-czas)"></span>
                    <span x-text="currentFlash().czas === 'N' ? 'NagÅ‚y' : 'TrwaÅ‚y'"></span>
                  </div>
                  <div class="card-axis-badge">
                    <span class="dot" style="background:var(--ax-prz)"></span>
                    <span x-text="currentFlash().prz === 'B' ? 'BezpoÅ›redni' : 'PoÅ›redni'"></span>
                  </div>
                </div>
                <div class="card-description" x-text="currentFlash().desc"></div>
                <div class="card-example" x-text="'PrzykÅ‚ad: ' + currentFlash().example"></div>
                <div class="card-rating-row">
                  <button class="btn-dontknow" @click.stop="rateFlash(false)">âœ— Nie znam</button>
                  <button class="btn-know" @click.stop="rateFlash(true)">âœ“ Znam</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </template>

      <!-- DONE state -->
      <template x-if="flashQueue.length === 0">
        <div class="text-center gm-card" style="padding:40px 24px;">
          <div style="font-size:2.4rem; margin-bottom:10px;">ðŸŽ‰</div>
          <div
            style="font-family:'Cinzel',serif; font-size:1.3rem; font-weight:700; margin-bottom:8px; color:var(--color-green);">
            RundÄ™ ukoÅ„czono!</div>
          <div style="font-size:.83rem; color:var(--color-muted); margin-bottom:20px;"
            x-text="`Znam: ${flashScore.know}  |  Nie znam: ${flashScore.dontknow}  |  NajdÅ‚uÅ¼sza seria: ${flashScore.streak}`">
          </div>
          <button class="quiz-next-btn" style="max-width:260px; margin:0 auto;" @click="resetFlash()">PowtÃ³rz</button>
        </div>
      </template>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MODE: QUIZ
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div x-show="mode === 'quiz'">

      <!-- quiz type selector -->
      <div class="quiz-type-selector">
        <button class="quiz-type-btn" :class="{active: quizType === 'name-to-code'}"
          @click="quizType = 'name-to-code'; nextQuiz();">
          Nazwa â†’ Kod
        </button>
        <button class="quiz-type-btn" :class="{active: quizType === 'code-to-name'}"
          @click="quizType = 'code-to-name'; nextQuiz();">
          Kod â†’ Nazwa
        </button>
        <button class="quiz-type-btn" :class="{active: quizType === 'name-to-desc'}"
          @click="quizType = 'name-to-desc'; nextQuiz();">
          Nazwa â†’ Opis
        </button>
        <button class="quiz-type-btn" :class="{active: quizType === 'desc-to-name'}"
          @click="quizType = 'desc-to-name'; nextQuiz();">
          Opis â†’ Nazwa
        </button>
      </div>

      <!-- scores -->
      <div class="score-ribbon">
        <div class="score-item">
          <div class="score-num green" x-text="quizScore.correct"></div>
          <div class="score-lbl">Poprawne</div>
        </div>
        <div class="score-item">
          <div class="score-num red" x-text="quizScore.wrong"></div>
          <div class="score-lbl">BÅ‚Ä™dne</div>
        </div>
        <div class="score-item">
          <div class="score-num gold" x-text="quizScore.streak"></div>
          <div class="score-lbl">SeriÄ™</div>
        </div>
      </div>

      <!-- question card - dynamic based on quiz type -->
      <div class="quiz-question">
        <div class="quiz-q-label" x-text="quizTypeLabel"></div>

        <!-- Nazwa â†’ Kod: show only name -->
        <template x-if="quizType === 'name-to-code'">
          <div>
            <div class="quiz-q-name" x-text="quizQ.name"></div>
          </div>
        </template>

        <!-- Kod â†’ Nazwa: show only code -->
        <template x-if="quizType === 'code-to-name'">
          <div>
            <div class="quiz-q-code">
              <span :style="`color:var(--ax-ciezar)`" x-text="quizQ.code[0]"></span>
              <span :style="`color:var(--ax-czas)`" x-text="quizQ.code[1]"></span>
              <span :style="`color:var(--ax-prz)`" x-text="quizQ.code[2]"></span>
            </div>
          </div>
        </template>

        <!-- Nazwa â†’ Opis: show only name -->
        <template x-if="quizType === 'name-to-desc'">
          <div>
            <div class="quiz-q-name" x-text="quizQ.name"></div>
          </div>
        </template>

        <!-- Opis â†’ Nazwa: show only description -->
        <template x-if="quizType === 'desc-to-name'">
          <div>
            <div class="quiz-q-desc" x-text="quizQ.desc"></div>
          </div>
        </template>
      </div>

      <!-- options -->
      <div class="quiz-options">
        <template x-for="(opt, idx) in quizOptions" :key="idx">
          <div class="quiz-option" :class="{
               correct:  quizAnswered && opt.isCorrect,
               wrong:    quizAnswered && quizPicked === idx && !opt.isCorrect,
               disabled: quizAnswered
             }" @click="answerQuiz(idx)">
            <div class="opt-letter" x-text="['A','B','C','D'][idx]"></div>
            <div class="opt-text">
              <!-- For name-to-code: show codes -->
              <template x-if="quizType === 'name-to-code'">
                <span>
                  <span :style="`color:var(--ax-ciezar); font-weight:700;`" x-text="opt.code[0]"></span>
                  <span :style="`color:var(--ax-czas); font-weight:700;`" x-text="opt.code[1]"></span>
                  <span :style="`color:var(--ax-prz); font-weight:700;`" x-text="opt.code[2]"></span>
                </span>
              </template>

              <!-- For code-to-name: show names -->
              <template x-if="quizType === 'code-to-name'">
                <span x-text="opt.name" style="font-weight: 600;"></span>
              </template>

              <!-- For name-to-desc: show descriptions -->
              <template x-if="quizType === 'name-to-desc'">
                <span x-text="opt.desc"></span>
              </template>

              <!-- For desc-to-name: show names -->
              <template x-if="quizType === 'desc-to-name'">
                <span x-text="opt.name" style="font-weight: 600;"></span>
              </template>
            </div>
          </div>
        </template>
      </div>

      <!-- feedback -->
      <div x-show="quizAnswered" class="quiz-feedback" :class="{correct: quizCorrect, wrong: !quizCorrect}">
        <template x-if="quizCorrect">
          <span>âœ“ Dobrze!</span>
        </template>
        <template x-if="!quizCorrect">
          <span>âœ— Å¹le.
            <template x-if="quizType === 'name-to-code'">
              <span><strong x-text="quizQ.name"></strong> to <strong x-text="quizQ.code"></strong>: <span
                  x-text="quizQ.desc"></span></span>
            </template>
            <template x-if="quizType === 'code-to-name'">
              <span><strong x-text="quizQ.code"></strong> to <strong x-text="quizQ.name"></strong>: <span
                  x-text="quizQ.desc"></span></span>
            </template>
            <template x-if="quizType === 'name-to-desc'">
              <span><strong x-text="quizQ.name"></strong>: <span x-text="quizQ.desc"></span></span>
            </template>
            <template x-if="quizType === 'desc-to-name'">
              <span><span x-text="quizQ.desc"></span> to <strong x-text="quizQ.name"></strong> (<span
                  x-text="quizQ.code"></span>)</span>
            </template>
          </span>
        </template>
      </div>

      <!-- next -->
      <button x-show="quizAnswered" class="quiz-next-btn" @click="nextQuiz()">NastÄ™pne â†’</button>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MODE: GM MODE
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div x-show="mode === 'gm'">

      <div class="gm-card">
        <div class="gm-header">
          <span class="gm-label">ðŸŽ­ Losowa PostaÄ‡</span>
          <button class="gm-reroll" @click="rollGM()">â†» Nowa postaÄ‡</button>
        </div>

        <!-- effort -->
        <div class="gm-effort-row">
          <div class="gm-effort-name" x-text="gmCombo.effort.name"></div>
          <div class="gm-effort-code">
            <span :style="`color:var(--ax-ciezar)`" x-text="gmCombo.effort.code[0]"></span><!--
          --><span :style="`color:var(--ax-czas)`" x-text="gmCombo.effort.code[1]"></span><!--
          --><span :style="`color:var(--ax-prz)`" x-text="gmCombo.effort.code[2]"></span>
          </div>
        </div>

        <!-- modifiers -->
        <div class="gm-modifiers">
          <template x-for="mod in gmCombo.mods" :key="mod.cat">
            <div class="gm-mod-chip">
              <span class="mod-cat" x-text="mod.cat"></span>
              <span x-text="mod.val"></span>
            </div>
          </template>
        </div>

        <!-- reveal / answer
        <button x-show="!gmRevealed" class="gm-reveal-btn" @click="gmRevealed = true">
          Skompiluj opis gÅ‚osu â†’
        </button> -->

        <div class="gm-answer">
          <div class="gm-answer-title">Opis gÅ‚osu</div>
          <div class="gm-answer-text" x-text="gmAnswer"></div>
          <div class="gm-answer-axes">
            <span class="gm-answer-axis" style="color:var(--ax-ciezar);"
              x-text="gmCombo.effort.ciezar==='S' ? 'â–² Stanowczy' : 'â–½ Delikatny'"></span>
            <span class="gm-answer-axis" style="color:var(--ax-czas);"
              x-text="gmCombo.effort.czas==='N' ? 'âš¡ NagÅ‚y' : 'ã€° TrwaÅ‚y'"></span>
            <span class="gm-answer-axis" style="color:var(--ax-prz);"
              x-text="gmCombo.effort.prz==='B' ? 'â†’ BezpoÅ›redni' : 'ã€° PoÅ›redni'"></span>
          </div>
        </div>
      </div>

      <!-- quick cheat sheet -->
      <details>
        <summary style="font-size:.8rem; color:var(--color-muted); cursor:pointer;">ÅšciÄ…ga â€” wszystkie 8 wysiÅ‚kÃ³w
        </summary>
        <div style="margin-top:10px; display:grid; grid-template-columns:1fr 1fr; gap:8px;">
          <template x-for="e in efforts" :key="e.code">
            <div
              style="background:var(--color-card-hi); border:1px solid var(--color-border); border-radius:var(--radius-sm); padding:10px 12px;">
              <div style="font-family:'Cinzel',serif; font-weight:700; font-size:.88rem;" x-text="e.name"></div>
              <div style="font-size:.72rem; letter-spacing:.14em; margin:2px 0 4px;">
                <span :style="`color:var(--ax-ciezar)`" x-text="e.code[0]"></span><!--
              --><span :style="`color:var(--ax-czas)`" x-text="e.code[1]"></span><!--
              --><span :style="`color:var(--ax-prz)`" x-text="e.code[2]"></span>
              </div>
              <div style="font-size:.72rem; color:var(--color-muted);" x-text="e.desc"></div>
            </div>
          </template>
        </div>
      </details>
    </div>

    <!-- CHEAT SHEET BUTTON -->
    <button class="cheatsheet-btn" @click="modalOpen = true">
      ðŸ“‹ ÅšciÄ…ga
    </button>

    <!-- MODAL FOR CHEAT SHEET -->
    <div x-show="modalOpen" class="modal-overlay" @click.self="modalOpen = false">
      <div class="modal-container">
        <div class="modal-header">
          <h3 class="modal-title">ÅšciÄ…ga â€” WysiÅ‚ki Labana</h3>
          <button class="modal-close" @click="modalOpen = false">Ã—</button>
        </div>

        <div class="modal-content">
          <div class="modal-image-container">
            <img id="cheatsheet-img" src="https://i.imgur.com/9rrlYF8.png" alt="Schemat wysiÅ‚kÃ³w Labana"
              data-zoom="https://i.imgur.com/9rrlYF8.png" class="drift-demo-trigger"
              style="max-width: 100%; cursor: zoom-in;">
            <p style="font-size: 0.8rem; color: var(--color-muted); margin-top: 1rem;">
              NajedÅº myszkÄ… na obrazek, Å¼eby przybliÅ¼yÄ‡. PrzeciÄ…gaj, Å¼eby przesunÄ…Ä‡ widok.
            </p>
          </div>
        </div>

        <div class="modal-footer">
          <button @click="modalOpen = false">Zamknij</button>
        </div>
      </div>
    </div>

  </div><!-- /app-shell -->
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.3/dist/cdn.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/drift-zoom@1/dist/Drift.min.js"></script>
  <script src="script.js"></script>
</body>

</html>